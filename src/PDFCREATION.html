<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pdf test</title>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>


</head>
<body>
    
    <a type="button" class="btn btn-secondary" id="download-order-pdf">
        Download a PDF of your product list
    </a>

    <div id="order-qty-table">
        <table>
            <tbody>
            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>CS1519</strong></td>
            <td class="sku-desc">Contour Small - Thick 2.4 ± 0.4mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>CS1518</strong></td>
            <td class="sku-desc">Contour Small - Medium 1.6 ± 0.4mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>RL1519</strong></td>
            <td class="sku-desc">RESTORE Large - Thick 2.4 ± 0.4mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>141608</strong></td>
            <td class="sku-desc">2cm x 4cm - Thin 1.0 ± 0.2mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>141632F</strong></td>
            <td class="sku-desc">4cm x 8cm Fenestrated - Thin 1.0 ± 0.2mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>141616F</strong></td>
            <td class="sku-desc">4cm x 4cm Fenestrated - Thin 1.0 ± 0.2mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>CXL1518P</strong></td>
            <td class="sku-desc">Contour X-Large Perforated - Medium 1.6 ± 0.4mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>CXL1519P</strong></td>
            <td class="sku-desc">Contour X-Large Perforated - Thick 2.4 ± 0.4mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>1519320P</strong></td>
            <td class="sku-desc">16cm x 20cm Perforated - Thick 2.4 ± 0.4mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>141400M</strong></td>
            <td class="sku-desc">Graftable Meshed X-Thin 0.55 ± 0.25mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>141430M</strong></td>
            <td class="sku-desc">5cm x 6cm Meshed - X-Thin 0.55 ± 0.25mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>CL1518</strong></td>
            <td class="sku-desc">Contour Large - Medium 1.6 ± 0.4mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>CL1519</strong></td>
            <td class="sku-desc">Contour Large - Thick 2.4 ± 0.4mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>CL1516</strong></td>
            <td class="sku-desc">Contour Large - Thin 1.0 ± 0.2mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>141448</strong></td>
            <td class="sku-desc">4cm x 12cm - X-Thin 0.55 ± 0.25mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>CL1518P</strong></td>
            <td class="sku-desc">Contour Large Perforated - Medium 1.6 ± 0.4mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>CL1516P</strong></td>
            <td class="sku-desc">Contour Large Perforated - Thin 1.0 ± 0.2mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>CL1519P</strong></td>
            <td class="sku-desc">Contour Large Perforated - Thick 2.4 ± 0.4mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>141821</strong></td>
            <td class="sku-desc">3cm x 7cm - Medium 1.6 ± 0.4mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>142221</strong></td>
            <td class="sku-desc">3cm x 7cm - X-Thick 3.4 ± 0.6mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>141621</strong></td>
            <td class="sku-desc">3cm x 7cm - Thin 1.0 ± 0.2mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>141921</strong></td>
            <td class="sku-desc">3cm x 7cm - Thick 2.4 ± 0.4mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>CS1518P</strong></td>
            <td class="sku-desc">Contour Small Perforated - Medium 1.6 ± 0.4mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>CS1519P</strong></td>
            <td class="sku-desc">Contour Small Perforated - Thick 2.4 ± 0.4mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>CS1516P</strong></td>
            <td class="sku-desc">Contour Small Perforated - Thin 1.0 ± 0.2mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>CXL1519</strong></td>
            <td class="sku-desc">Contour X-Large - Thick 2.4 ± 0.4mm </td>
            </tr>

            <tr>
            <td class="Qty">1</td>
            <td class="sku"><strong>CXL1518</strong></td>
            <td class="sku-desc">Contour X-Large - Medium 1.6 ± 0.4mm </td>
            </tr>
            </tbody>
        </table>
    </div>



    <script>
        $(document).ready(function () {
            var orderDatFinalObj = {},
    formData = {},
    orderDataFinalArr = [];

  $("#download-order-pdf").click(function () {
    orderDataFinalArr = [];
    $("#order-qty-table tr").each(function () {
      orderDatFinalObj = {
        ItemCode: $(this).children()[1].innerText,
        OrderDescription: $(this).children()[2].innerText,
        Quantity: $(this).children()[0].innerText,
      };
      orderDataFinalArr.push(orderDatFinalObj);
    });
    formData = {
      OrderDetails: orderDataFinalArr,
    };
    /*XML call for pdf download*/
    var xmlhttp = new XMLHttpRequest();
    xmlhttp.open("POST", "AllodermDownloadPDF/PDFDownload");
    xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
    xmlhttp.responseType = "blob";
    xmlhttp.onload = function (e) {
      if (this.status == 200) {
        var blob = new Blob([this.response], { type: "application/pdf" });
        console.log("download pdf");
        if (navigator.appVersion.toString().indexOf(".NET") > 0) {
          window.navigator.msSaveBlob(blob, "OrderPDF.pdf");
        } else {
          var blob = new Blob([this.response], { type: "application/pdf" });
          var file = window.URL.createObjectURL(blob);
          var a = document.createElement("a");
          var isDownload = "false";
          a.target = "_blank";
          a.href = file;
          if (isDownload) {
            a.download = "OrderPDF.pdf";
          }
          document.body.appendChild(a);
          if (isDownload) {
            a.click();
          } else {
            window.open(file, "_blank");
          }
          //$('#SuccessEmail').modal('show');
          setTimeout(function () {
            document.body.removeChild(a);
            window.URL.revokeObjectURL(file);
          }, 100);
        }
        $('.step0-wrapper').show();
        $('.sku-box, .sku-ordering-tool .header-section, .sku-ordering-tool .step-1').hide();
        $('#select-another-item').trigger('click');
        $('.cart-qty').removeClass('d-flex');
        $('.cart-qty').hide();
        currSel = "";
        $('.sku-ordering-tool').attr('curr-selection', '');
        $('#final-order-modal').modal('hide');

      } else {
        //parent.removeClass('building');
        //parent.addClass('initial');
        console.log("error");
      }
    };
    xmlhttp.send(JSON.stringify({ _answers: formData }));
  });
        });
    </script>
</body>
</html>